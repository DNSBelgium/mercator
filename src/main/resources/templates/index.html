<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <title>Mercator | Home </title>
    <script>
        function updateFormAction() {
            const form = document.getElementById('searchForm');
            const selectedOption = document.querySelector('input[name="option"]:checked').value;
            const fetchLatest = document.getElementById('fetchLatest');

            if (fetchLatest.checked) {
                form.action = '/search/' + selectedOption + '/latest';
            } else {
                form.action = '/search/' + selectedOption + '/ids';
            }
        }

    </script>
</head>

<body >

<div layout:fragment="content">
<!--    <h2>Welcome to Mercator</h2>-->

    <h2>Search for crawl results</h2>

    <a role="button" th:href="@{/search/tls}">TLS</a>
    <a role="button" th:href="@{/search/dns}">DNS</a>
    <a role="button" th:href="@{/search/smtp}">SMTP</a>
    <a role="button" th:href="@{/search/web}">Web</a>

    <p>
        <small>PS: Only the TLS button works for now</small>
    </p>


<!--    <p>-->
<!--        Search <a href="@{/search/dns}">DNS crawls</a>-->
<!--    </p>-->
<!--    <p>-->
<!--        Search <a th:href="@{/search/web}">web crawls</a>-->
<!--    </p>-->
<!--    <p>-->
<!--        Search <a th:href="@{/search/tls}">TLS crawls</a>-->
<!--    </p>-->
<!--    <p>-->
<!--        Search <a th:href="@{/search/smtp}">SMTP crawls</a>-->
<!--    </p>-->

<!--    <p>-->
<!--        <a th:href="@{/query}">Query</a>-->
<!--    </p>-->


    <!--        <p>-->
    <!--            <a th:href="@{/status}"> Check the crawling status </a>-->
    <!--        </p>-->

    <!--        <p>-->
    <!--            <a th:href="@{/hello}"> Test visualisation of a visit (fake data for now) </a>-->
    <!--        </p>-->

    <!--        <p>-->
    <!--            <a th:href="@{/test-htmx}"> Experiment with htmx </a>-->
    <!--        </p>-->

    <!--        <p>-->
    <!--            <a target="_blank" th:href="@{/actuator/scheduledtasks}">/actuator/scheduledtasks</a>-->
    <!--        </p>-->
    <!--        <p>-->
    <!--            <a target="_blank" th:href="@{/actuator/threaddump}">/actuator/threaddump</a>-->
    <!--        </p>-->

    <p></p>
    <p></p>
    <p></p>

    <h2>Input domain name you would like to search.</h2>
    <form id="searchForm" method="get" th:action="@{/search}" onsubmit="updateFormAction()">
        <div>
            <label for="textinput">Domain Name:</label>
            <input id="textinput" name="domainName" th:value="${domainName}" type="text">
        </div>
        <label>
            <input type="radio" name="option" value="web" th:checked="${option == 'web'}">
            Web
        </label>
        <label>
            <input type="radio" name="option" value="tls" th:checked="${option == 'tls'}">
            Tls
        </label>
        <label>
            <input type="radio" name="option" value="smtp" th:checked="${option == 'smtp'}">
            Smtp
        </label>
        <label>
            <input type="checkbox" id="fetchLatest" th:checked="${fetch_latest}">
            Fetch Latest
        </label>
        <button type="submit" onsubmit="updateFormAction()">submit</button>
    </form>

</div>



<th:block layout:fragment="page-scripts">
    <!-- Add additional scripts there that are only needed for this page (Application wide scripts should be added in layout/layout.html) -->
</th:block>

</body>
</html>