<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <title>Mercator | Home </title>
    <script>
        function updateFormAction() {
            const form = document.getElementById('searchForm');
            const fetchLatest = document.getElementById('fetchLatest');
            const moduleType = document.getElementById('moduleType').value

            if (fetchLatest.checked) {
                form.action = '/search/' + moduleType + '/latest';
            } else {
                form.action = '/search/' + moduleType + '/ids';
            }
        }
        function setVariable(value) {
            document.getElementById("moduleType").value = value;
            console.log(document.getElementById("moduleType"))
        }
        function dsf() {
            console.log("dse")
        }
    </script>
</head>

<body >

<div layout:fragment="content">
<!--    <h2>Welcome to Mercator</h2>-->

    <h2>Search for crawl results</h2>

<!--    <p>-->
<!--        Search <a href="@{/search/dns}">DNS crawls</a>-->
<!--    </p>-->
<!--    <p>-->
<!--        Search <a th:href="@{/search/web}">web crawls</a>-->
<!--    </p>-->
<!--    <p>-->
<!--        Search <a th:href="@{/search/tls}">TLS crawls</a>-->
<!--    </p>-->
<!--    <p>-->
<!--        Search <a th:href="@{/search/smtp}">SMTP crawls</a>-->
<!--    </p>-->

<!--    <p>-->
<!--        <a th:href="@{/query}">Query</a>-->
<!--    </p>-->


    <!--        <p>-->
    <!--            <a th:href="@{/status}"> Check the crawling status </a>-->
    <!--        </p>-->

    <!--        <p>-->
    <!--            <a th:href="@{/hello}"> Test visualisation of a visit (fake data for now) </a>-->
    <!--        </p>-->

    <!--        <p>-->
    <!--            <a th:href="@{/test-htmx}"> Experiment with htmx </a>-->
    <!--        </p>-->

    <!--        <p>-->
    <!--            <a target="_blank" th:href="@{/actuator/scheduledtasks}">/actuator/scheduledtasks</a>-->
    <!--        </p>-->
    <!--        <p>-->
    <!--            <a target="_blank" th:href="@{/actuator/threaddump}">/actuator/threaddump</a>-->
    <!--        </p>-->

    <p></p>
    <p></p>
    <p></p>

    <h2>Input domain name you would like to search.</h2>
    <input type="hidden" id="moduleType" name="moduleType" value="defaultValue">
    <form id="searchForm" method="get" th:action="@{/search}" onsubmit="updateFormAction()">
        <div>
            <label for="textinput">Domain Name:</label>
            <input id="textinput" name="domainName" th:value="${domainName}" type="text">
        </div>
        <button type="button" onclick="setVariable('tls')">TLS</button>
        <button type="button" onclick="setVariable('smtp')">SMTP</button>
        <button type="button" onclick="setVariable('web')">WEB</button>
        <button type="button" onclick="setVariable('dns')">DNS</button>
        <label>
            <input type="checkbox" th:checked="true" id="fetchLatest">
            Fetch Latest
        </label>
        <button type="submit" onsubmit="updateFormAction()">submit</button>
    </form>

</div>

<th:block layout:fragment="page-scripts">
    <!-- Add additional scripts there that are only needed for this page (Application wide scripts should be added in layout/layout.html) -->
</th:block>

</body>
</html>