<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
  <title>Mercator | Details</title>
</head>

<body >

<main class="container" layout:fragment="content">


  <h2 th:if="${smtpConversationResults == null or smtpConversationResults.isEmpty()}">
    No tls crawl results found for visitId <span th:text="${visitId}"></span>
  </h2>

  <div class="container-fluid">

    <div th:each="smtpConversationResult : ${smtpConversationResults}">
      <header>
        <h4>SMTP for:</h4>
        <h4 th:text="${smtpConversationResult.domainName}"></h4>
      </header>

      <table>
        <tbody>
        <tr>
          <th>visitId</th>
          <td th:text="${smtpConversationResult.visitId}"></td>
        </tr>
        <tr>
          <th>timestamp</th>
          <td th:text="${smtpConversationResult.timestamp}"></td>
        </tr>
        <tr>
          <th>numConversations</th>
          <td th:text="${smtpConversationResult.numConversations}"></td>
        </tr>
        <tr>
          <th>crawlStatus</th>
          <td th:text="${smtpConversationResult.crawlStatus}"></td>
        </tr>
        </tbody>
      </table>
      <div th:each="host, iterStat : ${smtpConversationResult.hosts}">
        <table>
          <tbody>
          <tr>
            <th><h4>Host #[[${iterStat.count}]]</h4></th>
            <td></td>
          </tr>
          <tr>
            <th>Id</th>
            <td th:text="${host.id}"></td>
          </tr>
          <tr>
            <th>fromMx</th>
            <td th:text="${host.fromMx}"></td>
          </tr>
          <tr>
            <th>hostName</th>
            <td th:text="${host.hostName}"></td>
          </tr>
          <tr>
            <th>priority</th>
            <td th:text="${host.priority}"></td>
          </tr>
          </tbody>
        </table>
        <table>
          <tbody>
          <h4>conversation for Host #[[${iterStat.count}]]</h4>
          <tr>
            <th>id</th>
            <td th:text="${host.conversation.id}"></td>
          </tr>
          <tr>
            <th>ip</th>
            <td th:text="${host.conversation.ip}"></td>
          </tr>
          <tr>
            <th>asn</th>
            <td th:text="${host.conversation.asn}"></td>
          </tr>
          <tr>
            <th>country</th>
            <td th:text="${host.conversation.country}"></td>
          </tr>
          <tr>
            <th>asnOrganisation</th>
            <td th:text="${host.conversation.asnOrganisation}"></td>
          </tr>
          <tr>
            <th>banner</th>
            <td th:text="${host.conversation.banner}"></td>
          </tr>
          <tr>
            <th>connectOK</th>
            <td th:text="${host.conversation.connectOK}"></td>
          </tr>
          <tr>
            <th>connectReplyCode</th>
            <td th:text="${host.conversation.connectReplyCode}"></td>
          </tr>
          <tr>
            <th>supportedExtensions</th>
            <td>
                <span th:each="ext : ${host.conversation.supportedExtensions}"
                      th:text="${ext + (iterStat.last ? '' : ', ')}"></span>
            </td>
          </tr>
          <tr>
            <th>ipVersion</th>
            <td th:text="${host.conversation.ipVersion}"></td>
          </tr>
          <tr>
            <th>startTlsOk</th>
            <td th:text="${host.conversation.startTlsOk}"></td>
          </tr>
          <tr>
            <th>startTlsReplyCode</th>
            <td th:text="${host.conversation.startTlsReplyCode}"></td>
          </tr>
          <tr>
            <th>errorMessage</th>
            <td th:text="${host.conversation.errorMessage}"></td>
          </tr><tr>
            <th>error</th>
            <td th:text="${host.conversation.error}"></td>
          </tr>
          <tr>
            <th>connectionTimeMs</th>
            <td th:text="${host.conversation.connectionTimeMs}"></td>
          </tr>
          <tr>
            <th>software</th>
            <td th:text="${host.conversation.software}"></td>
          </tr>
          <tr>
            <th>softwareVersion</th>
            <td th:text="${host.conversation.softwareVersion}"></td>
          </tr><tr>
            <th>timestamp</th>
            <td th:text="${host.conversation.timestamp}"></td>
          </tr>






          </tbody>
        </table>
      </div>






    </div>

  </div>

</main>


</body>
</html>
