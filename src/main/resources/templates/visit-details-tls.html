<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
  <title>Mercator | Details</title>
</head>

<body>

<main class="container" layout:fragment="content">

  <h2 th:if="${tlsCrawlResults == null or tlsCrawlResults.isEmpty()}">
    No TLS crawl results found for visitId <span th:text="${visitId}"></span>
  </h2>

  <div class="container-fluid" th:if="${tlsCrawlResults != null and not tlsCrawlResults.isEmpty()}">

    <div th:each="result : ${tlsCrawlResults}">
      <h3>Fresh</h3>
      <p th:text="${result.getFresh()}"></p>
      <h2>TLS result for domain: <span th:text="${result.visitRequest.domainName}">domain name</span></h2>

      <h3>visitRequest: </h3>
      <table>
        <tbody>

        <tr>
          <th>visitId</th>
          <td th:text="${result.visitRequest.visitId}"></td>
        </tr>
        <tr>
          <th>domainName</th>
          <td th:text="result.visitRequest.domainName"></td>
        </tr>
        </tbody>
      </table>

      <h3>fullScanEntity:</h3>
      <table>
        <tbody>

          <tr>
            <th>Id: </th>
            <td th:text="${result.fullScanEntity.id}"></td>
          </tr>
          <tr>
            <th>Crawl Timestamp: </th>
            <td th:text="${result.fullScanEntity.crawlTimestamp}"></td>
          </tr>
          <tr>
            <th>IP: </th>
            <td th:text="${result.fullScanEntity.ip}"></td>
          </tr>
          <tr>
            <th>Server Name: </th>
            <td th:text="${result.fullScanEntity.serverName}"></td>
          </tr>
          <tr>
            <th>Connect OK: </th>
            <td th:text="${result.fullScanEntity.connectOk}"></td>
          </tr>
          <tr>
            <th>Support TLS 1.3: </th>
            <td th:text="${result.fullScanEntity.supportTls_1_3}"></td>
          </tr>
          <tr>
            <th>Support TLS 1.2: </th>
            <td th:text="${result.fullScanEntity.supportTls_1_2}"></td>
          </tr>
          <tr>
            <th>Support TLS 1.1: </th>
            <td th:text="${result.fullScanEntity.supportTls_1_1}"></td>
          </tr>
          <tr>
            <th>Support TLS 1.0: </th>
            <td th:text="${result.fullScanEntity.supportTls_1_0}"></td>
          </tr>
          <tr>
            <th>Support SSL 3.0: </th>
            <td th:text="${result.fullScanEntity.supportSsl_3_0}"></td>
          </tr>
          <tr>
            <th>Support SSL 2.0: </th>
            <td th:text="${result.fullScanEntity.supportSsl_2_0}"></td>
          </tr>
          <tr>
            <th>Selected Cipher TLS 1.3: </th>
            <td th:text="${result.fullScanEntity.selectedCipherTls_1_3}"></td>
          </tr>
          <tr>
            <th>Selected Cipher TLS 1.2: </th>
            <td th:text="${result.fullScanEntity.selectedCipherTls_1_2}"></td>
          </tr>
          <tr>
            <th>Selected Cipher TLS 1.1: </th>
            <td th:text="${result.fullScanEntity.selectedCipherTls_1_1}"></td>
          </tr>
          <tr>
            <th>Selected Cipher TLS 1.0: </th>
            <td th:text="${result.fullScanEntity.selectedCipherTls_1_0}"></td>
          </tr>
          <tr>
            <th>Selected Cipher SSL 3.0: </th>
            <td th:text="${result.fullScanEntity.selectedCipherSsl_3_0}"></td>
          </tr>
          <tr>
            <th>Lowest Version Supported: </th>
            <td th:text="${result.fullScanEntity.lowestVersionSupported}"></td>
          </tr>
          <tr>
            <th>Highest Version Supported: </th>
            <td th:text="${result.fullScanEntity.highestVersionSupported}"></td>
          </tr>
          <tr>
            <th>Error TLS 1.3: </th>
            <td th:text="${result.fullScanEntity.errorTls_1_3}"></td>
          </tr>
          <tr>
            <th>Error TLS 1.2: </th>
            <td th:text="${result.fullScanEntity.errorTls_1_2}"></td>
          </tr>
          <tr>
            <th>Error TLS 1.1: </th>
            <td th:text="${result.fullScanEntity.errorTls_1_1}"></td>
          </tr>
          <tr>
            <th>Error TLS 1.0: </th>
            <td th:text="${result.fullScanEntity.errorTls_1_0}"></td>
          </tr>
          <tr>
            <th>Error SSL 3.0: </th>
            <td th:text="${result.fullScanEntity.errorSsl_3_0}"></td>
          </tr>
          <tr>
            <th>Error SSL 2.0: </th>
            <td th:text="${result.fullScanEntity.errorSsl_2_0}"></td>
          </tr>
          <tr>
            <th>Millis TLS 1.3: </th>
            <td th:text="${result.fullScanEntity.millis_tls_1_3}"></td>
          </tr>
          <tr>
            <th>Millis TLS 1.2: </th>
            <td th:text="${result.fullScanEntity.millis_tls_1_2}"></td>
          </tr>
          <tr>
            <th>Millis TLS 1.1: </th>
            <td th:text="${result.fullScanEntity.millis_tls_1_1}"></td>
          </tr>
          <tr>
            <th>Millis TLS 1.0: </th>
            <td th:text="${result.fullScanEntity.millis_tls_1_0}"></td>
          </tr>
          <tr>
            <th>Millis SSL 3.0: </th>
            <td th:text="${result.fullScanEntity.millis_ssl_3_0}"></td>
          </tr>
          <tr>
            <th>Millis SSL 2.0: </th>
            <td th:text="${result.fullScanEntity.millis_ssl_2_0}"></td>
          </tr>
          <tr>
            <th>Total Duration (ms): </th>
            <td th:text="${result.fullScanEntity.totalDurationInMs}"></td>
          </tr>
        </tbody>
      </table>


      <h3>Certificate chain</h3>
      <div th:each="cert, iterStat : ${result.certificateChain.get()}">
        <table>
          <tbody>
          <tr>
            <th>Certificate #[[${iterStat.count}]]</th>
            <td></td>
          </tr>
          <tr>
            <th>Subject</th>
            <td th:text="${cert.subject}"></td>
          </tr>
          <tr>
            <th>Issuer</th>
            <td th:text="${cert.issuer}"></td>
          </tr>
          <tr>
            <th>Valid From</th>
            <td th:text="${#dates.format(cert.notBefore, 'dd MMM yyyy HH:mm')}"></td>
          </tr>
          <tr>
            <th>Valid Until</th>
            <td th:text="${#dates.format(cert.notAfter, 'dd MMM yyyy HH:mm')}"></td>
          </tr>
          <tr>
            <th>Public Key</th>
            <td th:text="${cert.publicKeySchema + ' (' + cert.publicKeyLength + ')'}"></td>
          </tr>
          <tr>
            <th>SHA-256 Fingerprint</th>
            <td th:text="${cert.sha256Fingerprint}"></td>
          </tr>
          <tr>
            <th>Subject Alternative Names</th>
            <td>
                <span th:each="san : ${cert.subjectAlternativeNames}"
                      th:text="${san + (iterStat.last ? '' : ', ')}"></span>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <p>peer certificate: </p>
      <h3>Peer Certificate</h3>
      <div th:with="peerCert=${result.peerCertificate.get()}">
        <table class="table table-bordered">
          <tbody>
          <tr>
            <th>Subject</th>
            <td th:text="${peerCert.subject}"></td>
          </tr>
          <tr>
            <th>Issuer</th>
            <td th:text="${peerCert.issuer}"></td>
          </tr>
          <tr>
            <th>Valid From</th>
            <td th:text="${#dates.format(peerCert.notBefore, 'dd MMM yyyy HH:mm')}"></td>
          </tr>
          <tr>
            <th>Valid Until</th>
            <td th:text="${#dates.format(peerCert.notAfter, 'dd MMM yyyy HH:mm')}"></td>
          </tr>
          <tr>
            <th>Signature Algorithm</th>
            <td th:text="${peerCert.signatureHashAlgorithm}"></td>
          </tr>
          </tbody>
        </table>
        </div>
      </div>


      <pre th:text="${tlsCrawlResults}"></pre>






    </div>



  </div>

</main>

</body>
</html>